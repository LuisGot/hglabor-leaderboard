<div class="min-h-screen bg-white dark:bg-neutral-900 relative overflow-hidden">
  <div class="flex justify-center my-8 opacity-0 animate-fade-in">
    <img
      src="assets/images/norisk-logo.png"
      alt="NoRisk"
      class="h-32 pixelated opacity-0 animate-bounce-in"
    />
  </div>

  <div
    class="container mx-auto px-4 opacity-0 animate-fade-in animation-delay-150"
  >
    <div class="mb-4 opacity-0 animate-slide-up animation-delay-400">
      <input
        type="text"
        [value]="searchTerm()"
        (input)="onSearch($event)"
        placeholder="Search by username..."
        class="w-full px-4 py-2 bg-gray-50 dark:bg-neutral-800 backdrop-blur-sm rounded-lg border-2 border-[#2196F3]/30 focus:outline-none focus:border-[#2196F3] text-gray-800 dark:text-white text-xl"
      />
    </div>

    <div
      class="overflow-x-auto bg-gray-50 dark:bg-neutral-800 backdrop-blur-sm rounded-lg border-2 border-[#2196F3]/30 opacity-0 animate-slide-up animation-delay-500"
    >
      <div *ngIf="isLoading()" class="flex justify-center items-center py-20">
        <div
          class="animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-[#2196F3]"
        ></div>
      </div>
      <table
        *ngIf="!isLoading()"
        class="w-full border-separate border-spacing-1 text-sm md:text-base"
      >
        <thead>
          <tr>
            <th class="table-head">Place</th>
            <th class="table-head">Player</th>
            <th
              class="table-head cursor-pointer"
              [class]="currentSort() === 'xp' ? 'bg-[#2196F3]/30' : ''"
              (click)="sortByHeader('xp')"
            >
              <div class="flex items-center justify-center">
                XP
                <span *ngIf="currentSort() === 'xp'" class="ml-1">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-4 w-4"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      *ngIf="sortDirection() === 'desc'"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M19 9l-7 7-7-7"
                    />
                    <path
                      *ngIf="sortDirection() === 'asc'"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M5 15l7-7 7 7"
                    />
                  </svg>
                </span>
              </div>
            </th>
            <th
              class="table-head cursor-pointer"
              [class]="currentSort() === 'kills' ? 'bg-[#2196F3]/30' : ''"
              (click)="sortByHeader('kills')"
            >
              <div class="flex items-center justify-center">
                Kills
                <span *ngIf="currentSort() === 'kills'" class="ml-1">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-4 w-4"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      *ngIf="sortDirection() === 'desc'"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M19 9l-7 7-7-7"
                    />
                    <path
                      *ngIf="sortDirection() === 'asc'"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M5 15l7-7 7 7"
                    />
                  </svg>
                </span>
              </div>
            </th>
            <th
              class="table-head cursor-pointer"
              [class]="currentSort() === 'deaths' ? 'bg-[#2196F3]/30' : ''"
              (click)="sortByHeader('deaths')"
            >
              <div class="flex items-center justify-center">
                Deaths
                <span *ngIf="currentSort() === 'deaths'" class="ml-1">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-4 w-4"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      *ngIf="sortDirection() === 'desc'"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M19 9l-7 7-7-7"
                    />
                    <path
                      *ngIf="sortDirection() === 'asc'"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M5 15l7-7 7 7"
                    />
                  </svg>
                </span>
              </div>
            </th>
            <th
              class="table-head cursor-pointer"
              [class]="
                currentSort() === 'currentKillStreak' ? 'bg-[#2196F3]/30' : ''
              "
              (click)="sortByHeader('currentKillStreak')"
            >
              <div class="flex items-center justify-center">
                Current Streak
                <span
                  *ngIf="currentSort() === 'currentKillStreak'"
                  class="ml-1"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-4 w-4"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      *ngIf="sortDirection() === 'desc'"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M19 9l-7 7-7-7"
                    />
                    <path
                      *ngIf="sortDirection() === 'asc'"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M5 15l7-7 7 7"
                    />
                  </svg>
                </span>
              </div>
            </th>
            <th
              class="table-head cursor-pointer"
              [class]="
                currentSort() === 'highestKillStreak' ? 'bg-[#2196F3]/30' : ''
              "
              (click)="sortByHeader('highestKillStreak')"
            >
              <div class="flex items-center justify-center">
                Highest Streak
                <span
                  *ngIf="currentSort() === 'highestKillStreak'"
                  class="ml-1"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-4 w-4"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      *ngIf="sortDirection() === 'desc'"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M19 9l-7 7-7-7"
                    />
                    <path
                      *ngIf="sortDirection() === 'asc'"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M5 15l7-7 7 7"
                    />
                  </svg>
                </span>
              </div>
            </th>
            <th
              class="table-head cursor-pointer"
              [class]="currentSort() === 'bounty' ? 'bg-[#2196F3]/30' : ''"
              (click)="sortByHeader('bounty')"
            >
              <div class="flex items-center justify-center">
                Bounty
                <span *ngIf="currentSort() === 'bounty'" class="ml-1">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-4 w-4"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      *ngIf="sortDirection() === 'desc'"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M19 9l-7 7-7-7"
                    />
                    <path
                      *ngIf="sortDirection() === 'asc'"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M5 15l7-7 7 7"
                    />
                  </svg>
                </span>
              </div>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr
            *ngFor="let player of filteredLeaderboard(); let i = index"
            class="transition-colors hover:bg-[#2196F3]/5 opacity-0 animate-fade-in cursor-pointer"
            [ngStyle]="{ 'animation-delay': i * 40 + 'ms' }"
            [routerLink]="['/player', player.playerId]"
          >
            <td class="table-cell">
              {{ player.originalPlace }}
            </td>
            <td class="table-cell">
              <div class="flex flex-row items-center space-x-2">
                <img
                  [src]="player.avatar"
                  alt="{{ player.username }} avatar"
                  class="h-8 w-8 pixelated"
                />
                <span>{{ player.username }}</span>
              </div>
            </td>
            <td class="table-cell">{{ player.xp }}</td>
            <td class="table-cell">{{ player.kills }}</td>
            <td class="table-cell">{{ player.deaths }}</td>
            <td class="table-cell">{{ player.currentKillStreak }}</td>
            <td class="table-cell">{{ player.highestKillStreak }}</td>
            <td class="table-cell">{{ player.bounty }}</td>
          </tr>
        </tbody>
      </table>
      <div class="flex justify-center items-center gap-4 p-4">
        <button
          (click)="previousPage()"
          [disabled]="currentPage() === 1"
          class="btn-primary px-6 py-2 disabled:opacity-50 disabled:cursor-not-allowed"
        >
          Previous
        </button>
        <span class="text-xl text-gray-800 dark:text-white">
          Page {{ currentPage() }}
        </span>
        <button (click)="nextPage()" class="btn-primary px-6 py-2">Next</button>
      </div>
    </div>
  </div>
</div>
